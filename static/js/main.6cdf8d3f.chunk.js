(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{153:function(e,t,n){e.exports=n(307)},158:function(e,t,n){},159:function(e,t,n){},231:function(e,t){},233:function(e,t){},299:function(e,t){},300:function(e,t){},307:function(e,t,n){"use strict";n.r(t);var a=n(1),o=n.n(a),r=n(7),i=n.n(r),l=(n(158),n(70)),c=n(71),s=n(76),m=n(72),u=n(77),d=(n(159),n(312)),p=n(314),f=n(9),g=n(316),h=n(313),v=n(315),y=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(m.a)(t).call(this,e))).audio=void 0,n.timeout=20,n.setPlaySound=function(e){n.state.playSound!==e&&(e?n.audio.play():n.audio.pause(),n.setState({playSound:e}))},n.audio=new Audio("assets/sound/alert.wav"),n.audio.loop=!0,n.audio.playbackRate=.5,n.state={playSound:!1},n.setPlaySound(e.playSound),n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentWillReceiveProps",value:function(e){this.setPlaySound(e.playSound)}},{key:"render",value:function(){return o.a.createElement("div",null)}}]),t}(a.Component),E=n(310),b=n(311),S=30;function x(e){var t,n;return t=255*Math.min(e/S,1),n=255*Math.max(0,1-e/S),"rgb(".concat(t,", ").concat(20,", ").concat(n,")")}function w(e){return e>=10?e.toString():"0"+e.toString()}function k(e){var t=Number(e),n=Math.floor(t/3600),a=Math.floor((t-3600*n)/60),o=t-3600*n-60*a;return w(n)+":"+w(a)+":"+w(o)}function j(e){for(var t in e)if(Number(e[t].time)>S)return!0;return!1}var C=function(e){return o.a.createElement("div",null,o.a.createElement(y,{playSound:j(e.alarms)}),o.a.createElement(h.a,{dataSource:e.alarms,itemLayout:"horizontal",renderItem:function(e){return o.a.createElement(h.a.Item,{style:{background:x(Number(e.time)),margin:"2px 3px",padding:"5px",minHeight:"100px",marginBottom:"10px"}},o.a.createElement(h.a.Item.Meta,{title:o.a.createElement("div",null,o.a.createElement(E.a,null,o.a.createElement(b.a,{span:18,push:6},o.a.createElement("div",{style:{fontSize:"33px",color:"white",textAlign:"center",marginBottom:"20px"}},e.title),o.a.createElement(v.a,{percent:(t=Number(e.time),100*Math.min(t/S,1)),showInfo:!1,status:"active",strokeWidth:20})),o.a.createElement(b.a,{span:6,pull:18},o.a.createElement("div",{style:{color:"white",verticalAlign:"center",alignContent:"center",textAlign:"center"}},o.a.createElement("div",{style:{fontSize:"20px",marginBottom:"20px"}},"Time elasped"),o.a.createElement("div",{style:{fontSize:"40px"}},k(e.time))))))}));var t}}))},I=function(e){return o.a.createElement("div",null,o.a.createElement(h.a,{dataSource:e.logs,itemLayout:"horizontal",renderItem:function(e){return o.a.createElement(h.a.Item,{style:{margin:"2px 3px",padding:"5px",minHeight:"20px",marginBottom:"10px"}},o.a.createElement(h.a.Item.Meta,{title:o.a.createElement("div",{style:{fontSize:"20px"}},e.timestamp),description:o.a.createElement("div",{style:{fontSize:"20px"}},e.station," active for ",e.time)}))}}))},M=n(151),O=n(150),z=n.n(O);function A(e,t){var n=fetch("assets/config/settings.json").then(function(e){return e.json()}).catch(function(e){return console.log(e)}),a={keepalive:10,clientId:"mqttjs_"+Math.random().toString(16).substr(2,8),protocolId:"MQTT",protocolVersion:4,clean:!0,reconnectPeriod:1e3,connectTimeout:5e3,will:{topic:"WillMsg",payload:"Connection Closed abnormally..!",qos:0,retain:!1},rejectUnauthorized:!1},o={};e({message:"Connecting ",color:"info"});var r=null;return n.then(function(n){var i=z.a.connect(n.mqtt_server,a);i.subscribe("dio/#",{qos:2}),console.log("connection sub",n.mqtt_server),e({message:"Connecting ",color:"warning"}),function(t){t.on("connect",function(){console.log("Connected"),e({message:"Connection succeessful",color:"success"})}),t.on("reconnect",function(){console.log("connecting error"),t.connected||e({message:"connection failed",color:"error"})}),t.on("error",function(){console.log("connection error"),e({message:"connection failed ",color:"error"})})}(i),function(e){console.log("_registerChanges"),e.on("message",function(e,n){var a=e.split("/"),r=Object(M.a)(a,2),i=(r[0],r[1]),l=JSON.parse(n.toString());o[i]={time:l.time,value:l.value};var c=[];for(var s in o)1===o[s].value&&c.push({title:s,time:o[s].time});c.sort(function(e,t){return Number(t.time)-Number(e.time)}),t(c)})}(i),r=function(){console.log("disconnecting"),i.end(!0)}}),r}var N=d.a.Header,q=d.a.Content,P=d.a.Footer,B=d.a.Sider,T={log:[{timestamp:"21/06/2019 05:02:00 PM",station:"Station 1",time:"00:15:00"},{timestamp:"21/06/2019 05:01:00 PM",station:"Station 2",time:"00:12:00"},{timestamp:"21/06/2019 04:01:00 PM",station:"Station 3",time:"00:23:45"}]},_=function(e){function t(e){var n;return Object(l.a)(this,t),(n=Object(s.a)(this,Object(m.a)(t).call(this,e))).mqtt_sub=void 0,n.onCollapse=function(e){n.setState({collapsed:e})},n.onSelect=function(e){n.setState({content:e.key})},n.state={collapsed:!1,content:"1",alarms:[],status:{color:"info",message:"Initializing"}},n}return Object(u.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){var e=this;this.mqtt_sub=A(function(t){e.setState({status:t})},function(t){e.setState({alarms:t})})}},{key:"componentWillUnmount",value:function(){this.mqtt_sub()}},{key:"render",value:function(){var e=this;return o.a.createElement(d.a,{style:{minHeight:"100vh"}},o.a.createElement(B,{collapsible:!0,collapsed:this.state.collapsed,onCollapse:this.onCollapse},o.a.createElement("div",{className:"logo",style:{margin:"5px 10px"}}),o.a.createElement(p.b,{theme:"dark",defaultSelectedKeys:["1"],mode:"inline",onSelect:this.onSelect},o.a.createElement(p.b.Item,{key:"1"},o.a.createElement(f.a,{type:"warning"}),o.a.createElement("span",null,"Alarms")),o.a.createElement(p.b.Item,{key:"2"},o.a.createElement(f.a,{type:"database"}),o.a.createElement("span",null,"Report")))),o.a.createElement(d.a,null,o.a.createElement(N,{style:{background:"#fff",padding:0,textAlign:"center",fontSize:20}},o.a.createElement("div",{style:{marginBottom:"10px"}},o.a.createElement("h1",{className:"title-header",style:{textTransform:"uppercase",textOverflow:"ellipsis"}},"Smart Dashboard"),o.a.createElement(g.a,{message:this.state.status.message,type:this.state.status.color,showIcon:!0,style:{textAlign:"left",fontSize:15,textOverflow:"ellipsis",textJustify:"inter-word",textTransform:"capitalize"}}))),o.a.createElement(q,{style:{margin:"16px"}},o.a.createElement("div",{style:{padding:24,background:"#fff",minHeight:360,marginTop:"20px"}},function(){switch(e.state.content){case"1":return o.a.createElement(C,{alarms:e.state.alarms});case"2":return o.a.createElement(I,{logs:T.log});default:return o.a.createElement("div",null,"Unknown option selected")}}())),o.a.createElement(P,{style:{textAlign:"center"}},"Smart Dashboard 2019 Created by Aimtech")))}}]),t}(o.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(o.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[153,1,2]]]);
//# sourceMappingURL=main.6cdf8d3f.chunk.js.map